<!DOCTYPE html>
<html lang="es">
<%- include('partials/head') %>
<body>

  <%- include('./partials/header') %>

  <div class="container products-wrapper">
    <div class="row">

      <div class="col-12">
        <h2 class="products-title">Resultados de búsqueda</h2>
      </div>

      <% if (mensaje) { %>
        <div class="col-12">
          <p><%= mensaje %></p>
        </div>
      <% } else { %>

        <% if (proddd) { %>

          <% if (proddd.length > 0) { %>

            <% for (var i = 0; i < proddd.length; i++) { %>
              <div class="col-12 col-sm-6 col-lg-3">
                <section class="product-box">
                  <a href="/product/detalle/<%= proddd[i].id %>">

                    <!-- Muestra la imagen solo si existe -->
                    <% if (proddd[i].imagenArchivo) { %>
                      <figure class="product-box_image">
                        <img src="/images/products/<%= proddd[i].imagenArchivo %>" alt="">
                      </figure>
                    <% } %>

                    <article class="product-box_data">
                      <h2>
                        <% if (proddd[i].nombre) { %>
                          <%= proddd[i].nombre %>
                        <% } else { %>
                          <% if (proddd[i].nombreProducto) { %>
                            <%= proddd[i].nombreProducto %>
                          <% } else { %>
                            Sin nombre
                          <% } %>
                        <% } %>
                      </h2>

                      <% if (proddd[i].descripcion) { %>
                        <p><%= proddd[i].descripcion %></p>
                      <% } %>

                      <!-- Me salía error, entonces va con: soporta usuario.nombre o usuario_nombre -->
                      <p><strong>Vendedor/a:</strong>
                        <% if (proddd[i].usuario) { %>
                          <% if (proddd[i].usuario.nombre) { %>
                            <%= proddd[i].usuario.nombre %>
                          <% } else { %>
                            No informado
                          <% } %>
                        <% } else { %>
                          <% if (proddd[i].usuario_nombre) { %>
                            <%= proddd[i].usuario_nombre %>
                          <% } else { %>
                            No informado
                          <% } %>
                        <% } %>
                      </p>

                      <p><strong>Comentarios:</strong>
                        <% if (proddd[i].comentarios) { %>
                          <%= proddd[i].comentarios.length %>
                        <% } else { %>
                          0
                        <% } %>
                      </p>
                    </article>
                  </a>
                </section>
              </div>
            <% } %>

          <% } else { %>
            <div class="col-12"><p>No se encontraron resultados.</p></div>
          <% } %>

        <% } else { %>
          <div class="col-12"><p>No se encontraron resultados.</p></div>
        <% } %>

      <% } %>
    </div>
  </div>

  <%- include('partials/footer') %>
</body>
</html>
